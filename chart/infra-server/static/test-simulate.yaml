apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: simulate-
spec:
  entrypoint: start
  onExit: stop
  arguments:
    parameters:
      - name: name
      - name: create-delay-seconds
      - name: create-outcome
      - name: destroy-delay-seconds
      - name: destroy-outcome

  templates:
    - name: start
      dag:
        tasks:
          - name: create
            templateRef:
              name: test-simulate
              template: simulate
            arguments:
              parameters:
              - name: delay-seconds
                value: '{{ "{{" }}workflow.parameters.create-delay-seconds{{ "}}" }}'
              - name: outcome
                value: '{{ "{{" }}workflow.parameters.create-outcome{{ "}}" }}'

          - name: wait
            dependencies: [create]
            templateRef:
              name: common
              template: wait

    - name: stop
      dag:
        tasks:
          - name: destroy
            templateRef:
              name: test-simulate
              template: simulate
            arguments:
              parameters:
              - name: delay-seconds
                value: '{{ "{{" }}workflow.parameters.destroy-delay-seconds{{ "}}" }}'
              - name: outcome
                value: '{{ "{{" }}workflow.parameters.destroy-outcome{{ "}}" }}'
